<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Bugfixed Sulexh MD Pairing</title>
<script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>

<style>
body {
  background: #000915;
  color: white;
  font-family: Arial;
  padding: 20px;
  text-align: center;
}
.card {
  padding: 20px;
  border-radius: 15px;
  background: #0a1222;
  margin-top: 20px;
}
input {
  padding: 12px;
  width: 80%;
  border-radius: 10px;
  background: #000;
  border: 1px solid #222;
  color: white;
  font-size: 16px;
}
button {
  margin-top: 15px;
  padding: 14px;
  width: 80%;
  border-radius: 25px;
  background: linear-gradient(to right, orange, green);
  border: none;
  font-size: 18px;
  font-weight: bold;
  color: #000;
}
.code-box {
  font-size: 40px;
  margin-top: 10px;
}
</style>
</head>

<body>

<h1 style="color:#00ff8c">PAIRING CODE</h1>
<h3>BUGFIXED-SULEXH-MD MULTI DEVICE</h3>

<div class="card">
  <p>Please enter your phone number with country code:</p>
  <input id="phone" placeholder="2547XXXXXXXX">

  <button onclick="pairNow()">SUBMIT</button>

  <div id="status" style="margin-top:20px;font-size:18px;">
    No session yet
  </div>

  <div class="code-box" id="paircode"></div>
</div>

<script>
const socket = io();

// Submit phone number
function pairNow() {
  const number = document.getElementById("phone").value;

  if (!number) return alert("Enter phone number!");

  document.getElementById("status").innerText = "Requesting Pair Code...";

  fetch("/pair", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ number })
  });
}

// Listen for pairing code
socket.on("pairing_code", (data) => {
  document.getElementById("status").innerText = "Pair Code Generated:";
  document.getElementById("paircode").innerText = data.code;
});

// Linked
socket.on("paired_success", (data) => {
  document.getElementById("status").innerText = "Linked Successfully!";
  document.getElementById("paircode").innerText = "";
});

// Error
socket.on("pair_error", (data) => {
  document.getElementById("status").innerText = "Error: " + data.error;
  document.getElementById("paircode").innerText = "";
});
</script>

</body>
</html>
